<!--START PRE-POPULATE PICKLISTS-->
<script type="text/javascript">
function prePopulatePicklists() {

  // 0: Field ID | 1: Marketo Token
  var arrayPrepopSelect = [
    [document.getElementById('Marketing_Country__c'), "{{lead.Marketing Country}}"],
    [document.getElementById('Title_Category__c'), "{{lead.Title Category}}"],
    [document.getElementById('Job_Function__c'), "{{lead.Job Function}}"],
    [document.getElementById('Marketing_Automation__c'), "{{lead.Marketing Automation}}"],
    [document.getElementById('Business_Type__c'), "{{lead.Business Type}}"]
  ]

  for (var i = 0; i < arrayPrepopSelect.length; i++) { //Loop through the number of fields defined above
    for (var x=0; x<arrayPrepopSelect[i][0].length; x++) { //Loop through the number of options in the drop down
      if (arrayPrepopSelect[i][1]==arrayPrepopSelect[i][0].options[x].value) {
        arrayPrepopSelect[i][0].value = arrayPrepopSelect[i][1];
        break;
      }
    }
  }
}
</script>
<!--END PRE-POPULATE PICKLISTS-->

<!--START PROPULATE JOB ROLE OPTIONS-->
<script>
function populateJobRoleOptions() {

  var fieldJobFunctionID = document.getElementById('Job_Function__c').value;
  var fieldJobRoleID = document.getElementById('Job_Role__c');
  var mktoTokenJobRole = "{{lead.Job Role}}";

  var arrayMarketingOptions = ["Business Operations", "Content Marketer", "Copywriter", "Corporate Communications", "Creative", "Demand Generation", "Editor", "Event Management", "Field Marketing", "Intern", "Marketing Analyst", "Marketing Automation", "Marketing Leadership", "Marketing Operations", "Product Marketer", "Project Manager", "Public Relations", "Sales Operations", "SEO", "Social", "Other"]

  var arraySalesOptions = ["Business Operations", "Demand Generation", "Sales Leadership", "Sales Operations", "Sales Representative", "Other"]

  var arrayAccountingOptions = ["Accounts Payable", "Business Operations", "Marketing Operations", "Procurement", "Sales Operations", "Other"]

  //Marketing
  if (fieldJobFunctionID == "Marketing") {
    fieldJobRoleID.options.length = 0;
    fieldJobRoleID.options[fieldJobRoleID.options.length] = new Option('Job Role...', '', true, true);
    //Add the array as options to Job Role
    for(index in arrayMarketingOptions) {
        fieldJobRoleID.options[fieldJobRoleID.options.length] = new Option(arrayMarketingOptions[index], arrayMarketingOptions[index]);
    }
    //If Marketo Token is in the array, set Job Role to the Marketo Token value
    if(arrayMarketingOptions.indexOf('{{lead.Job Role}}') !== -1){
      fieldJobRoleID.value = "{{lead.Job Role}}";
    }

  }

  //Sales
  if (fieldJobFunctionID == "Sales") {
    fieldJobRoleID.options.length = 0;
    fieldJobRoleID.options[fieldJobRoleID.options.length] = new Option('Job Role...', '', true, true);
    for(index in arraySalesOptions) {
        fieldJobRoleID.options[fieldJobRoleID.options.length] = new Option(arraySalesOptions[index], arraySalesOptions[index]);
    }
    if(arraySalesOptions.indexOf('{{lead.Job Role}}') !== -1){
      fieldJobRoleID.value = "{{lead.Job Role}}";
    }
  }

  //Accounting, Finance or Purchasing
  if (fieldJobFunctionID == "Accounting" || fieldJobFunctionID == "Finance" || fieldJobFunctionID == "Purchasing") {
    fieldJobRoleID.options.length = 0;
    fieldJobRoleID.options[fieldJobRoleID.options.length] = new Option('Job Role...', '', true, true);
    for(index in arrayAccountingOptions) {
        fieldJobRoleID.options[fieldJobRoleID.options.length] = new Option(arrayAccountingOptions[index], arrayAccountingOptions[index]);
    }
    if(arrayAccountingOptions.indexOf('{{lead.Job Role}}') !== -1){
      fieldJobRoleID.value = "{{lead.Job Role}}";
    }
  }

}

</script>
<!--END PROPULATE JOB ROLE OPTIONS-->

<!--START SHOW/HIDE PRE-POPULATED FORM FIELDS-->
<script type="text/javascript">
  var fieldFirstName = document.getElementById('FirstName');
  var fieldLastName = document.getElementById('LastName');
  var fieldPhone = document.getElementById('Phone');
  var fieldCompany = document.getElementById('Company');
  var fieldMarketingCountry = document.getElementById('Marketing_Country__c');
  var fieldTitleCategory = document.getElementById('Title_Category__c');
  var fieldJobFuntion = document.getElementById('Job_Function__c');
  var fieldJobRole = document.getElementById('Job_Role__c');
  var fieldMarketingAutomation = document.getElementById('Marketing_Automation__c');
  var fieldBusinessType = document.getElementById('Business_Type__c');

  //Fade Out (Hide) Form Fields
  function hideKnownFields() {

    var myVariableArray = [fieldFirstName, fieldLastName, fieldPhone, fieldCompany, fieldTitleCategory, fieldJobFuntion, fieldJobRole, fieldMarketingAutomation, fieldBusinessType];

    var arrayLength = myVariableArray.length;

    for (var i = 0; i < arrayLength; i++) {
      if ((myVariableArray[i].value) !== '') {
        $(myVariableArray[i]).parents('div').eq(1).fadeOut();
        $(myVariableArray[i]).addClass("ignore");
      }
    }

  }

  //Fade In (Show) Form Fields
  function showAllFields() {

    var myVariableArray = [fieldFirstName, fieldLastName, fieldPhone, fieldCompany, fieldTitleCategory, fieldJobFuntion, fieldJobRole, fieldMarketingAutomation, fieldBusinessType];

    var arrayLength = myVariableArray.length;

    for (var i = 0; i < arrayLength; i++) {
      $(myVariableArray[i]).parents('div').eq(1).fadeIn();
      $(myVariableArray[i]).removeClass("ignore");
    }

  }

</script>
<!--END SHOW/HIDE PRE-POPULATED FORM FIELDS-->


<!--START FORM RESET-->
<script>
function clearFormShowHide() {

  //var hideKnownFieldsValue = ${mkto-form-showhide};
  var hideKnownFieldsValue = false;

  if (hideKnownFieldsValue == true) {
    hideKnownFields(); //hide fields and remove requirement

    $('#clearForm').on('click', function() {
      $("#kapostmktoform")[0].reset(); //clears validation, but Marketo tokens return
      $('#kapostmktoform').find('input:text, input:password, select, textarea').val(''); //clears Marketo tokens out of fields
      showAllFields(); //show all fields again and make them required again
    });

  } else {

    $('#clearForm').on('click', function() {
      $("#kapostmktoform")[0].reset(); //clears validation, but Marketo tokens return
      $('#kapostmktoform').find('input:text, input:password, select, textarea').val(''); //clears Marketo tokens out of fields
    });

  }

}
</script>
<!--END FORM RESET-->


<!--START HIDE NEWSLETTER OPTION FOR SUBSCRIBERS-->
<script type="text/javascript">
var newsletterWrapper = document.getElementById('newsletter-wrapper');

if ("{{lead.Subscribed to Newsletter}}" == 1) {
  $(newsletterWrapper).fadeOut();
} else {
  $(newsletterWrapper).fadeIn();
}

</script>
<!--END HIDE NEWSLETTER OPTION FOR SUBSCRIBERS-->

<script>
//Privacy Policy Show/Hide
function checkForExpressCountry() {

  userMarktingCountry = document.getElementById('Marketing_Country__c').value;
  arrayExpressCountry = ["Canada","Germany","Australia"];
  var wrapperPrivacyStatement = document.getElementById('privacy-statement');

  if(arrayExpressCountry.indexOf(userMarktingCountry) !== -1){
    $(wrapperPrivacyStatement).fadeIn();
  } else {
    $(wrapperPrivacyStatement).fadeOut();
  }

}

  $("[id=Marketing_Country__c]").change(checkForExpressCountry);
</script>


<script>
//START VALIDATION CONFIG + REMOVE COOKIES ON SUBMIT

$("#kapostmktoform").validate({

  ignore: ".ignore",
  rules: {
    FirstName: {required: true},
    LastName: {required: true},
    Email: {required: true, email: true},
    Phone: {required: true},
    Company: {required: true},
    Marketing_Country__c: {required: true},
    Title_Category__c: {required: true},
    Job_Function__c: {required: true},
    Job_Role__c:
    { required:
      { depends:
        function () { //Start Function

          var userJobFunction = document.getElementById('Job_Function__c').value;
          var listJobFunction = ["Marketing","Sales","Finance","Accounting","Purchasing"];

          if( $.inArray(userJobFunction, listJobFunction) != -1){
            return true;
          } else {
            return false;
          }

        } //End Function
      } //End Depends
    }, //End Required
    Marketing_Automation__c: {required: true},
    Business_Type__c: {required: true},
    legalCheckbox:
    { required:
      { depends:
        function () { //Start Function

          if(arrayExpressCountry.indexOf(userMarktingCountry) !== -1){
            return true;
          } else {
            return false;
          }

        } //End Function
      } //End Depends
    } //End Required
  }, //End Rules

  submitHandler: function($form) {
    Cookies.remove('kapostsearch', { domain: 'kapost.com' });
    Cookies.remove('kapostsocial', { domain: 'kapost.com' });
    Cookies.remove('kapostsource', { domain: 'kapost.com' });
    Cookies.remove('kapostpaid', { domain: 'kapost.com' });
    Cookies.remove('kapostsearch');
    Cookies.remove('kapostsocial');
    Cookies.remove('kapostsource');
    Cookies.remove('kapostpaid');
    alert("submit hander function ran");
    form.submit();
  }

}); //End .validate


</script>
