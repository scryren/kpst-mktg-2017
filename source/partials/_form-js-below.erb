<!--START PRE-POPULATE PICKLISTS-->
<script type="text/javascript">
function prePopulatePicklists() {

  // 0: Field ID | 1: Marketo Token
  var arrayPrepopSelect = [
    [document.getElementById('Marketing_Country__c'), "{{lead.Marketing Country}}"],
    [document.getElementById('Title_Category__c'), "{{lead.Title Category}}"],
    [document.getElementById('Department'), "{{lead.Department}}"],
    [document.getElementById('Marketing_Automation__c'), "{{lead.Marketing Automation}}"],
    [document.getElementById('Business_Type__c'), "{{lead.Business Type}}"]
  ]

  for (var i = 0; i < arrayPrepopSelect.length; i++) { //Loop through the number of fields defined above
    for (var x=0; x<arrayPrepopSelect[i][0].length; x++) { //Loop through the number of options in the drop down
      if (arrayPrepopSelect[i][1]==arrayPrepopSelect[i][0].options[x].value) {
        arrayPrepopSelect[i][0].value = arrayPrepopSelect[i][1];
        break;
      }
    }
  }
}
</script>
<!--END PRE-POPULATE PICKLISTS-->

<!--START PROPULATE JOB ROLE OPTIONS-->
<script>
function populateJobRoleOptions() {

  var fieldDepartmentID = document.getElementById('Department').value;
  var fieldJobRoleID = document.getElementById('Job_Role__c');
  var mktoTokenJobRole = "{{lead.Job Role}}";

  hasProperJobRoleCombo = false;

  var arrayDepartmentsWithRoles = ["Marketing","Sales","Finance","Accounting","Purchasing"];

  arrayMarketingOptions = ["Business Operations", "Content Marketer", "Copywriter", "Corporate Communications", "Creative", "Demand Generation", "Editor", "Event Management", "Field Marketing", "Intern", "Marketing Analyst", "Marketing Automation", "Marketing Leadership", "Marketing Operations", "Product Marketer", "Project Manager", "Public Relations", "Sales Operations", "SEO", "Social", "Other"]

  arraySalesOptions = ["Business Operations", "Demand Generation", "Sales Leadership", "Sales Operations", "Sales Representative", "Other"]

  arrayAccountingOptions = ["Accounts Payable", "Business Operations", "Marketing Operations", "Procurement", "Sales Operations", "Other"]

  //Not Applicable Departments/Role Combos
  if(fieldDepartmentID !== "" && mktoTokenJobRole == "Not Applicable" && arrayDepartmentsWithRoles.indexOf(fieldDepartmentID) == -1){
    hasProperJobRoleCombo = true;
  }

  //Marketing
  if (fieldDepartmentID == "Marketing") {
    fieldJobRoleID.options.length = 0;
    fieldJobRoleID.options[fieldJobRoleID.options.length] = new Option('Job Role...', '', true, true);
    //Add the array as options to Job Role
    for(index in arrayMarketingOptions) {
        fieldJobRoleID.options[fieldJobRoleID.options.length] = new Option(arrayMarketingOptions[index], arrayMarketingOptions[index]);
    }
    //If Marketo Token is in the array, set Job Role to the Marketo Token value
    if(arrayMarketingOptions.indexOf('{{lead.Job Role}}') !== -1){
      fieldJobRoleID.value = "{{lead.Job Role}}";
      hasProperJobRoleCombo = true;
    }

  }

  //Sales
  if (fieldDepartmentID == "Sales") {
    fieldJobRoleID.options.length = 0;
    fieldJobRoleID.options[fieldJobRoleID.options.length] = new Option('Job Role...', '', true, true);
    for(index in arraySalesOptions) {
        fieldJobRoleID.options[fieldJobRoleID.options.length] = new Option(arraySalesOptions[index], arraySalesOptions[index]);
    }
    if(arraySalesOptions.indexOf('{{lead.Job Role}}') !== -1){
      fieldJobRoleID.value = "{{lead.Job Role}}";
      hasProperJobRoleCombo = true;
    }
  }

  //Accounting, Finance or Purchasing
  if (fieldDepartmentID == "Accounting" || fieldDepartmentID == "Finance" || fieldDepartmentID == "Purchasing") {
    fieldJobRoleID.options.length = 0;
    fieldJobRoleID.options[fieldJobRoleID.options.length] = new Option('Job Role...', '', true, true);
    for(index in arrayAccountingOptions) {
        fieldJobRoleID.options[fieldJobRoleID.options.length] = new Option(arrayAccountingOptions[index], arrayAccountingOptions[index]);
    }
    if(arrayAccountingOptions.indexOf('{{lead.Job Role}}') !== -1){
      fieldJobRoleID.value = "{{lead.Job Role}}";
      hasProperJobRoleCombo = true;
    }
  }

}

</script>
<!--END PROPULATE JOB ROLE OPTIONS-->



<!--START FORM RESET-->
<script>/*
function clearFormShowHide() {

  var hideKnownFieldsValue = ${mkto-form-showhide};
  //var hideKnownFieldsValue = false;

  if (hideKnownFieldsValue == true) {
    hideKnownFields(); //hide fields and remove requirement

    $('#clearForm').on('click', function() {
      $("#kapostmktoform")[0].reset(); //clears validation, but Marketo tokens return
      $('#kapostmktoform').find('input:text, input:password, select, textarea').val(''); //clears Marketo tokens out of fields
      showAllFields(); //show all fields again and make them required again
    });

  } else {

    $('#clearForm').on('click', function() {
      $("#kapostmktoform")[0].reset(); //clears validation, but Marketo tokens return
      $('#kapostmktoform').find('input:text, input:password, select, textarea').val(''); //clears Marketo tokens out of fields
    });

  }

} */
</script>
<!--END FORM RESET-->


<!--START HIDE NEWSLETTER OPTION FOR SUBSCRIBERS-->
<script type="text/javascript">
var newsletterWrapper = document.getElementById('newsletter-wrapper');

if ("{{lead.Subscribed to Newsletter}}" == 1) {
  $(newsletterWrapper).fadeOut();
} else {
  $(newsletterWrapper).fadeIn();
}

</script>
<!--END HIDE NEWSLETTER OPTION FOR SUBSCRIBERS-->

<script>
//Privacy Policy Show/Hide
function checkForExpressCountry() {

  userMarktingCountry = document.getElementById('Marketing_Country__c').value;
  arrayExpressCountry = ["Canada","Germany","Australia"];
  var wrapperPrivacyStatement = document.getElementById('privacy-statement');

  //if the user's Country value is Canada, etc., add privacy statement to layout
  if(arrayExpressCountry.indexOf(userMarktingCountry) !== -1){
    $(wrapperPrivacyStatement).fadeIn();
  } else {
    $(wrapperPrivacyStatement).fadeOut();
  }

}

  $("[id=Marketing_Country__c]").change(checkForExpressCountry);
</script>



<!--START SHOW/HIDE PRE-POPULATED FORM FIELDS-->
<script type="text/javascript">

function showHideFields() {

  var mktoTokenJobRole = "{{lead.Job Role}}";
  var mktoTokenDepartment = "{{lead.Department}}";

  var arrayShowHideFieldID = [
    [document.getElementById('FirstName'), "{{lead.First Name}}"],
    [document.getElementById('LastName'), "{{lead.Last Name}}"],
    [document.getElementById('Phone'), "{{lead.Phone Number}}"],
    [document.getElementById('Company'), "{{company.Company Name}}"],
    [document.getElementById('Title_Category__c'), "{{lead.Title Category}}"],
    [document.getElementById('Marketing_Automation__c'), "{{lead.Marketing Automation}}"],
    [document.getElementById('Business_Type__c'), "{{lead.Business Type}}"]
  ]

/*
  //If correct combo, hide Department and Job Role by adding it to arrayShowHideFieldID
  if (hasProperJobRoleCombo == true) {
    arrayShowHideFieldID.push(
      [document.getElementById('Department'), "{{lead.Department}}"],
      [document.getElementById('Job_Role__c'), "{{lead.Job Role}}"]
    );
  }

  //If incorrect combo, hide only Job Role by adding it to arrayShowHideFieldID (let Department logic turn it back on), reset Department and Job Role
  if (hasProperJobRoleCombo == false) {
    arrayShowHideFieldID.push(
      [document.getElementById('Job_Role__c'), "{{lead.Job Role}}"]
    );
    document.getElementById('Department').value = "";
    document.getElementById('Job_Role__c').value = "";

  } */

  for (var i = 0; i < arrayShowHideFieldID.length; i++) { //Loop through the number of fields defined above

      if (arrayShowHideFieldID[i][1] !== "") {
        $(arrayShowHideFieldID[i][0]).parents('div').eq(0).fadeOut();
        $(arrayShowHideFieldID[i][0]).parents('fieldset').eq(0).fadeOut();
        $(arrayShowHideFieldID[i][0]).addClass("ignore");
      } else {
        $(arrayShowHideFieldID[i][0]).parents('div').eq(0).fadeIn();
        $(arrayShowHideFieldID[i][0]).parents('fieldset').eq(0).fadeIn();
        $(arrayShowHideFieldID[i][0]).removeClass("ignore");

      }

    }

}
</script>
<!--END SHOW/HIDE PRE-POPULATED FORM FIELDS-->

<script>
//START VALIDATION CONFIG + REMOVE COOKIES ON SUBMIT

$("#kapostmktoform").validate({

  ignore: ".ignore",
  rules: {
    FirstName: {required: true},
    LastName: {required: true},
    Email: {required: true, email: true},
    Phone: {required: true},
    Company: {required: true},
    Marketing_Country__c: {required: true},
    Title_Category__c: {required: true},
    Department: {required: true},
    Job_Role__c:
    { required:
      { depends:
        function () { //Start Function

          var userDepartment = document.getElementById('Department').value;
          var listDepartment = ["Marketing","Sales","Finance","Accounting","Purchasing"];

          if( $.inArray(userDepartment, listDepartment) != -1){
            return true;
          } else {
            return false;
          }

        } //End Function
      } //End Depends
    }, //End Required
    Marketing_Automation__c: {required: true},
    Business_Type__c: {required: true},
    legalCheckbox:
    { required:
      { depends:
        function () { //Start Function

          if(arrayExpressCountry.indexOf(userMarktingCountry) !== -1){
            return true;
          } else {
            return false;
          }

        } //End Function
      } //End Depends
    } //End Required
  }, //End Rules

  submitHandler: function($form) {
    Cookies.remove('kapostsearch', { domain: 'kapost.com' });
    Cookies.remove('kapostsocial', { domain: 'kapost.com' });
    Cookies.remove('kapostsource', { domain: 'kapost.com' });
    Cookies.remove('kapostpaid', { domain: 'kapost.com' });
    Cookies.remove('kapostsearch');
    Cookies.remove('kapostsocial');
    Cookies.remove('kapostsource');
    Cookies.remove('kapostpaid');
    alert("submit hander function ran");
    form.submit();
  }

}); //End .validate


</script>
